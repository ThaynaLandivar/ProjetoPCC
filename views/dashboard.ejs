<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    
    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        google.charts.load('current', {packages:['corechart']});
        google.charts.setOnLoadCallback(drawCharts);

        function drawCharts() {
            drawLineChart();
            drawPieChart();
            drawBarChart();
        }

        function drawLineChart() {
            var data = google.visualization.arrayToDataTable([
                ['Mês', 'Valor Órgão', 'Valor Philips'],
                ['Jan', 30000, 25000],
                ['Fev', 35000, 27000],
                ['Mar', 40000, 29000],
                ['Abr', 45000, 31000],
                ['Mai', 50000, 33000]
            ]);

            var options = {
                title: 'Comparação de Valores',
                curveType: 'function',
                legend: { position: 'bottom' }
            };

            var chart = new google.visualization.LineChart(document.getElementById('line_chart_div'));
            chart.draw(data, options);
        }

        function drawPieChart() {
            var data = google.visualization.arrayToDataTable([
                ['Estado', 'Quantidade de Processos'],
                ['SP', 20],
                ['RJ', 15],
                ['MG', 10],
                ['RS', 8],
                ['PR', 5]
            ]);

            var options = {
                title: 'Processos por Estado'
            };

            var chart = new google.visualization.PieChart(document.getElementById('pie_chart_div'));
            chart.draw(data, options);
        }

        function drawBarChart() {
            var data = google.visualization.arrayToDataTable([
                ['Representante', 'Processos Abertos'],
                ['Ana', 10],
                ['Bruno', 8],
                ['Carlos', 12],
                ['Daniela', 9]
            ]);

            var options = {
                title: 'Processos por Representante',
                chartArea: {width: '50%'},
                hAxis: {
                    title: 'Quantidade',
                    minValue: 0
                },
                vAxis: {
                    title: 'Representante'
                }
            };

            var chart = new google.visualization.BarChart(document.getElementById('bar_chart_div'));
            chart.draw(data, options);
        }

        function filterTable() {
            let estadoFiltro = document.getElementById("estadoFiltro").value.toLowerCase();
            let tabela = document.getElementById("processTable");
            let linhas = tabela.getElementsByTagName("tr");

            for (let i = 1; i < linhas.length; i++) {
                let estadoColuna = linhas[i].getElementsByTagName("td")[3]; // Coluna Estado
                if (estadoColuna) {
                    let estadoTexto = estadoColuna.textContent.toLowerCase();
                    if (estadoTexto.includes(estadoFiltro) || estadoFiltro === "") {
                        linhas[i].style.display = "";
                    } else {
                        linhas[i].style.display = "none";
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div class="dashboard-container">
        <header class="header">
            <button class="logout-btn" onclick="window.location.href='/logout'">SAIR</button>
        </header>

        <div class="content">
            <div class="card">
                <h2>Gráfico de Valores</h2>
                <div id="line_chart_div" style="width: 100%; height: 400px;"></div>
            </div>
            <div class="card">
                <h2>Processos por Estado</h2>
                <div id="pie_chart_div" style="width: 100%; height: 400px;"></div>
            </div>
            <div class="card">
                <h2>Processos por Representante</h2>
                <div id="bar_chart_div" style="width: 100%; height: 400px;"></div>
            </div>

            <!-- Filtro -->
            <div class="filter-container">
                <label for="estadoFiltro">Filtrar por Estado:</label>
                <input type="text" id="estadoFiltro" placeholder="Digite o estado">
                <button class="filter-btn" onclick="filterTable()">Filtrar</button>
            </div>

            <div class="table-container">
                <h2>Lista de Processos</h2>
                <table id="processTable">
                    <thead>
                        <tr>
                            <th>Opp</th>
                            <th>Representante</th>
                            <th>Cliente</th>
                            <th>Estado</th>
                            <th>Tipo do Processo</th>
                            <th>Equipamento</th>
                            <th>Configuração</th>
                            <th>Atende Tecnicamente</th>
                            <th>Data de Abertura</th>
                            <th>Valor Órgão</th>
                            <th>Valor Philips</th>
                            <th>Prazo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>001</td>
                            <td>Ana</td>
                            <td>Hospital X</td>
                            <td>SP</td>
                            <td>Compra Direta</td>
                            <td>Ultrassom</td>
                            <td>Modelo A</td>
                            <td>Sim</td>
                            <td>01/02/2024</td>
                            <td>R$ 30.000</td>
                            <td>R$ 25.000</td>
                            <td>30 dias</td>
                        </tr>
                        <tr>
                            <td>002</td>
                            <td>Bruno</td>
                            <td>Clínica Y</td>
                            <td>RJ</td>
                            <td>Licitação</td>
                            <td>Raio-X</td>
                            <td>Modelo B</td>
                            <td>Não</td>
                            <td>15/02/2024</td>
                            <td>R$ 35.000</td>
                            <td>R$ 27.000</td>
                            <td>45 dias</td>
                        </tr>
                        <tr>
                            <td>003</td>
                            <td>Carlos</td>
                            <td>Clínica Z</td>
                            <td>MG</td>
                            <td>Licitação</td>
                            <td>Ressonância</td>
                            <td>Modelo C</td>
                            <td>Não</td>
                            <td>10/05/2024</td>
                            <td>R$ 33.000</td>
                            <td>R$ 28.000</td>
                            <td>35 dias</td>
                        </tr>
                        <tr>
                            <td>004</td>
                            <td>Daniela</td>
                            <td>Hospital K</td>
                            <td>RS</td>
                            <td>Compra Direta</td>
                            <td>Tumografia</td>
                            <td>Modelo D</td>
                            <td>Sim</td>
                            <td>16/01/2024</td>
                            <td>R$ 30.000</td>
                            <td>R$ 25.000</td>
                            <td>25 dias</td>    
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
